function getEmbedScriptPath(d){var b=document.getElementsByTagName("script"),f="",c="";for(var a=0;a<b.length;a++){b[a].src.match(d)&&(f=b[a].src)}f!=""&&(c="/");return f.split("?")[0].split("/").slice(0,-1).join("/")+c}function createStoryJS(V,G){if(G&&G.timelineContent instanceof Array){G.timeline={headline:G.name,type:"default",text:G.name,date:[],asset:G.asset||{}};for(var P=0;P<G.timelineContent.length;P++){var ab=G.timelineContent[P].data;G.timeline.date=G.timeline.date.concat(ab)}for(var P=0;P<G.timeline.date.length;P++){var W=G.timeline.date[P];var Y=W.date.replace(/(\d{4})\D+(\d{1,2})\D+(\d{1,2})\D+(\d{1,2})\D+(\d{1,2}).+/,"$1,$2,$3, $4,$5");W.startDate=W.endDate=Y;G.timeline=G.timeline||Y;W.headline=W.title;W.text=W.text||W.title+' <a href="'+(G.basePath||"")+W.url+'" target="_blank" >\u8be6\u60c5</a>';G.timeline.date[P]={startDate:Y,endDate:Y,headline:W.title,text:W.text||W.title+' <a href="'+(G.basePath||"")+W.url+'" target="_blank" >\u8be6\u60c5</a>',asset:W.asset||{media:W.titleImg?((G.basePicPath||"")+W.titleImg):undefined}}}G={timeline:G.timeline}}function R(){LoadLib.js(Q.js,z)}function z(){O.js=!0;Q.lang!="en"?LazyLoad.js(X.locale,Z):O.language=!0;A()}function Z(){O.language=!0;A()}function B(){O.css=!0;A()}function F(){O.font.css=!0;A()}function k(){O.font.js=!0;A()}function A(){if(O.checks>40){return}O.checks++;if(O.js&&O.css&&O.font.css&&O.font.js&&O.language){if(!O.finished){O.finished=!0;q()}}else{O.timeout=setTimeout("onloaded_check_again();",250)}}function j(){var a="storyjs-embed";I=document.createElement("div");Q.embed_id!=""?P=document.getElementById(Q.embed_id):P=document.getElementById("timeline-embed");P.appendChild(I);I.setAttribute("id",Q.id);if(Q.width.toString().match("%")){P.style.width=Q.width.split("%")[0]+"%"}else{Q.width=Q.width-2;P.style.width=Q.width+"px"}if(Q.height.toString().match("%")){P.style.height=Q.height;a+=" full-embed";P.style.height=Q.height.split("%")[0]+"%"}else{if(Q.width.toString().match("%")){a+=" full-embed";Q.height=Q.height-16;P.style.height=Q.height+"px"}else{a+=" sized-embed";Q.height=Q.height-16;P.style.height=Q.height+"px"}}P.setAttribute("class",a);P.setAttribute("className",a);I.style.position="relative"}function q(){VMM.debug=Q.debug;L=new VMM.Timeline(Q.id);L.init(Q);K&&VMM.bindEvent(global,onHeadline,"HEADLINE")}var L,I,P,H,K=!1,D="2.24",aa="1.7.1",U="",O={timeout:"",checks:0,finished:!1,js:!1,css:!1,jquery:!1,has_jquery:!1,language:!1,font:{css:!1,js:!1}},X={base:embed_path,css:embed_path+"css/",js:embed_path+"js/",locale:embed_path+"js/locale/",jquery:"//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js",font:{google:!1,css:embed_path+"css/themes/font/",js:"//ajax.googleapis.com/ajax/libs/webfont/1/webfont.js"}},Q={version:D,debug:!1,type:"timeline",id:"storyjs",embed_id:"timeline-embed",embed:!0,width:"100%",height:"100%",source:"https://docs.google.com/spreadsheet/pub?key=0Agl_Dv6iEbDadFYzRjJPUGktY0NkWXFUWkVIZDNGRHc&output=html",lang:"en",font:"default",css:X.css+"timeline.css?"+D,js:"",api_keys:{google:"",flickr:"",twitter:""},gmap_key:""},J=[{name:"Merriweather-NewsCycle",google:["News+Cycle:400,700:latin","Merriweather:400,700,900:latin"]},{name:"NewsCycle-Merriweather",google:["News+Cycle:400,700:latin","Merriweather:300,400,700:latin"]},{name:"PoiretOne-Molengo",google:["Poiret+One::latin","Molengo::latin"]},{name:"Arvo-PTSans",google:["Arvo:400,700,400italic:latin","PT+Sans:400,700,400italic:latin"]},{name:"PTSerif-PTSans",google:["PT+Sans:400,700,400italic:latin","PT+Serif:400,700,400italic:latin"]},{name:"PT",google:["PT+Sans+Narrow:400,700:latin","PT+Sans:400,700,400italic:latin","PT+Serif:400,700,400italic:latin"]},{name:"DroidSerif-DroidSans",google:["Droid+Sans:400,700:latin","Droid+Serif:400,700,400italic:latin"]},{name:"Lekton-Molengo",google:["Lekton:400,700,400italic:latin","Molengo::latin"]},{name:"NixieOne-Ledger",google:["Nixie+One::latin","Ledger::latin"]},{name:"AbrilFatface-Average",google:["Average::latin","Abril+Fatface::latin"]},{name:"PlayfairDisplay-Muli",google:["Playfair+Display:400,400italic:latin","Muli:300,400,300italic,400italic:latin"]},{name:"Rancho-Gudea",google:["Rancho::latin","Gudea:400,700,400italic:latin"]},{name:"Bevan-PotanoSans",google:["Bevan::latin","Pontano+Sans::latin"]},{name:"BreeSerif-OpenSans",google:["Bree+Serif::latin","Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800:latin"]},{name:"SansitaOne-Kameron",google:["Sansita+One::latin","Kameron:400,700:latin"]},{name:"Lora-Istok",google:["Lora:400,700,400italic,700italic:latin","Istok+Web:400,700,400italic,700italic:latin"]},{name:"Pacifico-Arimo",google:["Pacifico::latin","Arimo:400,700,400italic,700italic:latin"]}];if(typeof V=="object"){for(H in V){Object.prototype.hasOwnProperty.call(V,H)&&(Q[H]=V[H])}}typeof G!="undefined"&&(Q.source=G);if(typeof url_config=="object"){K=!0;Q.source.match("docs.google.com")||Q.source.match("json")||Q.source.match("storify")||(Q.source="https://docs.google.com/spreadsheet/pub?key="+Q.source+"&output=html")}if(Q.js.match("locale")){Q.lang=Q.js.split("locale/")[1].replace(".js","");Q.js=X.js+"timeline-min.js?"+D}if(!Q.js.match("/")){Q.css=X.css+Q.type+".css?"+D;Q.js=X.js+Q.type;Q.debug?Q.js+=".js?"+D:Q.js+="-min.js?"+D;Q.id="storyjs-"+Q.type}Q.lang.match("/")?X.locale=Q.lang:X.locale=X.locale+Q.lang+".js?"+D;j();LoadLib.css(Q.css,B);if(Q.font=="default"){O.font.js=!0;O.font.css=!0}else{var W;if(Q.font.match("/")){W=Q.font.split(".css")[0].split("/");X.font.name=W[W.length-1];X.font.css=Q.font}else{X.font.name=Q.font;X.font.css=X.font.css+Q.font+".css?"+D}LoadLib.css(X.font.css,F);for(var C=0;C<J.length;C++){if(X.font.name==J[C].name){X.font.google=!0;WebFontConfig={google:{families:J[C].google}}}}X.font.google?LoadLib.js(X.font.js,k):O.font.js=!0}try{O.has_jquery=jQuery;O.has_jquery=!0;if(O.has_jquery){var U=parseFloat(jQuery.fn.jquery);U<parseFloat(aa)?O.jquery=!1:O.jquery=!0}}catch(M){O.jquery=!1}O.jquery?R():LoadLib.js(X.jquery,R);this.onloaded_check_again=function(){A()}}LazyLoad=function(q){function x(c,f){var e=q.createElement(c),a;for(a in f){f.hasOwnProperty(a)&&e.setAttribute(a,f[a])}return e}function w(c){var a=b[c],h,f;if(a){h=a.callback;f=a.urls;f.shift();k=0;if(!f.length){h&&h.call(a.context,a.obj);b[c]=null;z[c].length&&j(c)}}}function p(){var a=navigator.userAgent;y={async:q.createElement("script").async===!0};(y.webkit=/AppleWebKit\//.test(a))||(y.ie=/MSIE/.test(a))||(y.opera=/Opera/.test(a))||(y.gecko=/Gecko\//.test(a))||(y.unknown=!0)}function j(n,c,f,a,s){var C=function(){w(n)},e=n==="css",r=[],u,t,B,D,h,A;y||p();if(c){c=typeof c=="string"?[c]:c.concat();if(e||y.async||y.gecko||y.opera){z[n].push({urls:c,callback:f,obj:a,context:s})}else{for(u=0,t=c.length;u<t;++u){z[n].push({urls:[c[u]],callback:u===t-1?f:null,obj:a,context:s})}}}if(b[n]||!(D=b[n]=z[n].shift())){return}g||(g=q.head||q.getElementsByTagName("head")[0]);h=D.urls;for(u=0,t=h.length;u<t;++u){A=h[u];if(e){B=y.gecko?x("style"):x("link",{href:A,rel:"stylesheet"})}else{B=x("script",{src:A});B.async=!1}B.className="lazyload";B.setAttribute("charset","utf-8");if(y.ie&&!e){B.onreadystatechange=function(){if(/loaded|complete/.test(B.readyState)){B.onreadystatechange=null;C()}}}else{if(e&&(y.gecko||y.webkit)){if(y.webkit){D.urls[u]=B.href;m()}else{B.innerHTML='@import "'+A+'";';v(B)}}else{B.onload=B.onerror=C}}r.push(B)}for(u=0,t=r.length;u<t;++u){g.appendChild(r[u])}}function v(c){var a;try{a=!!c.sheet.cssRules}catch(f){k+=1;k<200?setTimeout(function(){v(c)},50):a&&w("css");return}w("css")}function m(){var c=b.css,a;if(c){a=d.length;while(--a>=0){if(d[a].href===c.urls[0]){w("css");break}}k+=1;c&&(k<200?setTimeout(m,50):w("css"))}}var y,g,b={},k=0,z={css:[],js:[]},d=q.styleSheets;return{css:function(f,a,h,c){j("css",f,a,h,c)},js:function(f,a,h,c){j("js",f,a,h,c)}}}(this.document);LoadLib=function(b){function c(f){var g=0,d=!1;for(g=0;g<a.length;g++){a[g]==f&&(d=!0)}if(d){return !0}a.push(f);return !1}var a=[];return{css:function(h,f,g,d){c(h)||LazyLoad.css(h,f,g,d)},js:function(h,f,g,d){c(h)||LazyLoad.js(h,f,g,d)}}}(this.document);var WebFontConfig;if(typeof embed_path=="undefined"||typeof embed_path=="undefined"){var embed_path=getEmbedScriptPath("storyjs-embed.min.js")}(function(){typeof url_config=="object"?createStoryJS(url_config):typeof timeline_config=="object"?createStoryJS(timeline_config):typeof storyjs_config=="object"?createStoryJS(storyjs_config):typeof config=="object"&&createStoryJS(config)})();
